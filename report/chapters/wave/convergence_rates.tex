\section{Numerical Results}

\subsection{Rate of Convergence}
\label{subsec:conv_rate_wave}
To reproduce the expected convergence rates and therein check the validity of our implementation we follow a similar sequence of steps as already presented in section \ref{subsec:conv_rate_ell}.  

\begin{stepscope}
    \begin{step}[Domain]
    We fix the domain $\Omega = (0,10)$, an extended version for better visualization, and set the final time to $T = 10$. 
    \end{step}

    \begin{step}[Exact Solution]
        We decide to approximate the smooth exact solutions 
        \begin{equation*}
            u_1(x,t) = e^{-(x-t+2)^2} ,\qquad u_2(x,t) = \sin(x-t - \pi) \nonumber.
        \end{equation*}
    \end{step}
    
    \begin{step}[Coefficient]
        We fix the smooth coefficients 
        \begin{equation*}
            c_1(x,t) = 1, \quad c_2(x,t) = (\sin(x) + 2)(\cos(t) + 2), \quad c_3(x,t) = \sin(x) + 2, \quad c_4(x,t) = \sin(t) + 2.
        \end{equation*}
        To ensure our exact solution still satisfies the original pde, we calculate the forcing term $f$ in (\ref{eq:elliptic_pde}) symbolically, i.e.\ 
        $f_{i,j} = \partial_t^2 u_i - \partial_x(c_j \partial_x u_i)$.
    \end{step}

    \begin{step}[Boundary and Initial Conditions]
        As done in the last chapter we focus on reproducing the convergence rates for Dirichlet boundary conditions on both sides, we directly take the values provided by 
        the exact solution $u$ we start with as boundary conditions, meaning 
        \begin{equation*}
            g(x,t) = u(x,t) \qquad \forall(x,t) \in \{0,10\} \times [0,T].
        \end{equation*}
        We do the same thing for the initial conditions and in total for $i \in \{1,2\}$ and $j \in \{1,2,3,4\} $ we solve the pde: \\
        Find $u \in C^2([0,T];H^2(\Omega))$ such that 
        \begin{subequations}
            \begin{align*}
                u_{tt} - (c_j u_x)_x &= \partial_t^2 u_i - \partial_x (c_j \partial_x u_i)  &&\text{in } \Omega \times [0,T], \\
                u(0,\cdot) = u_i(0, \cdot), \quad u(10,\cdot) &= u_i(10,\cdot)  &&\text{in } [0, T], \\
                u(\cdot, 0) = u_i(\cdot, 0), \quad u_t(\cdot, 0) &= \partial_t u_i(\cdot, 0)  &&\text{in } \Omega.
            \end{align*}
        \end{subequations}
        In the case of the coefficient $c_1$ we observe that the solution $u \in \{u_1, u_2\}$ satisfies the absorbing boundary condition exactly. When imposing the absorbing
        boundary condition at the upper boundary and a Dirichlet boundary condition ($g(0,t) = u(0,t)$), or a Neumann boundary condition ($g(0,t) = -u_x(0,t)$) at the lower boundary
        we observe the exact same expected convergence rates as in the double Dirichlet case.
    \end{step}

    \begin{step}[Mesh]
        We choose an initial equidistant mesh of meshsize $h = 1$
        \begin{equation*}
           \mathcal{T}_h^{(0)} = \{(0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7), (7, 8), (8, 9), (9, 10) \}, 
        \end{equation*}
        but the results do not vary for any kind of initial mesh. We fix a number of refinement cycles and obtain a sequence of nested meshes by refining every element each cycle.
        We fix a stepsize scaling factor $\gamma > 0$, such that $\Delta t = \gamma h$ on each of the nested meshes. We have found that $ \gamma  = \frac{1}{50r} $ ensures stability 
        for all chosen coefficients in the case of the equidistant mesh. 
    \end{step}

    \begin{step}[Numerical Approximation]
        Again we only consider $\mathcal{P}^1$- and  $\mathcal{P}^2$-elements, so $r\in \{1,2\}$, 
        and fix a sufficiently large penalization parameter $\sigma = 10(r+1)^2$ to ensure coercivity. We calculate the numerical solution at each timestep using the time-marching scheme 
        (\ref{eq:wave_fully_discrete_system}). Due to the time-dependent bilinear and linear forms we now have to reassemble the stiffness matrix 
        $\mathbf{B}(t)$ and the load vector $\mathbf{l}(t)$ at each timestep anew. This is 
        very costly, especially for growing global degrees of freedom (decreasing meshsize). Luckily for $c_1, c_3, c_4$ we do not in fact have to reassemble everything only for
        $c_2$ we are forced to brute force the iteration.
        In the case of $c \in \{c_1, c_3\}$ the coefficient is not time-dependent at all and therefore neither are the entries of the stiffness matrix, so it holds that 
        \begin{equation*}
            \mathbf{B}(t) = \mathbf{B}(0) \qquad \forall t \in [0, T].
        \end{equation*}
        The majority of the load vector depending on the source term $f$ can also be tested for time-independency, this occurs for example in the case $c = c_1$. In such a case 
        the whole system, aside from the boundary conditions, can be reused every timestep. Since the majority of computation time is required to assemble the system, reusing as much as possible 
        provides a substantial benefit.
    \end{step}

    \begin{step}[Error Computation]
        We consider the error between the exact and numerical solution at the endtime $T$, specifically we consider
        \begin{enumerate}
            \item The $L^2$-error $\displaystyle \|u(T) - u_h(T)\|_{L^2(\Omega)}$;
            \item The broken $H^1$-error $\displaystyle \|u(T) - u_h(T)\|_{H^1(\mathcal{T}_h )}$;
            \item The error in the energy norm $\displaystyle \|u(T) - u_h(T)\|_{\epsilon}$.
        \end{enumerate}
        We compute all these errors for both exact solutions $u_1, u_2$ on each mesh in the sequence of nested (equidistant) meshes.
    \end{step}
\end{stepscope}

\begin{figure}[h!]
    \centering
    
    \begin{minipage}[t]{0.44\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_uniform_mesh_exact_sol_errors_P1.jpg}
        \caption{Errors of SIPG in space and leapfrog in time for $P^1$-elements}
        \label{fig:wave_uniform_mesh_error_p1}
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.44\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_uniform_mesh_exact_sol_errors_P2.jpg}
        \caption{Errors of SIPG in space and leapfrog in time for $P^2$-elements}
        \label{fig:wave_uniform_mesh_error_p2}
    \end{minipage}
\end{figure}

The results vary only slightly for different permutations of parameters. In Figures 
\ref{fig:wave_uniform_mesh_error_p1}, \ref{fig:wave_uniform_mesh_error_p2} we show the errors computed for the exact solution $u_2$ and the constant coefficient $c_1$ 
for both $\mathcal{P}^1$- and $\mathcal{P}^2$-elements. We observe a considerable gain in accuracy by employing $\mathcal{P}^2$-elements over $\mathcal{P}^1$-elements. 
It seems that we gain an order of convergence when upgrading to $\mathcal{P}^2$-elements. This is indeed the case in the broken $H^1$-norm and energy norm, but since 
leapfrog limits the error to behave like $\mathcal{O}(\Delta t^2)$ and we coupled $\Delta t = \gamma h$ we expect that for $h \to 0$ even the $L^2$-error curve
will flatten and behave like $\mathcal{O}(h^2)$.  
% TODO: put detailed explanation why O(h^3) is an illusion and reference to theory part


\subsection{Visualization of the SIPG-leapfrog Solution}
In Figures \ref{fig:uniform_mesh_wave_sol_1_p1}-\ref{fig:uniform_mesh_wave_sol_2_p2} 
we visualize the numerical solutions created in \ref{subsec:conv_rate_wave} at the final time $T = 10$ on the once refined mesh
$\mathcal{T}_h^{(1)}$. Clearly the choice of the coefficient $c$ does not influence the picture since we artificially modify the pde to output the desired exact solution. 

\begin{figure}[h!]
    \centering
    
    \begin{minipage}[t]{0.44\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_num_sol_1_p1.jpg}
        \caption{$u_1$ with $P^1$-elements}
        \label{fig:uniform_mesh_wave_sol_1_p1}
        \vspace{10pt}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_num_sol_2_p1.jpg}
        \caption{$u_2$ with $P^1$-elements}
        \label{fig:uniform_mesh_wave_sol_2_p1}
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.44\textwidth}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_num_sol_1_p2.jpg}
        \caption{$u_1$ with $P^2$-elements}
        \label{fig:uniform_mesh_wave_sol_1_p2}
        \vspace{10pt}
        \centering
        \includegraphics[width=\linewidth]{figures/dg_wave_num_sol_2_p2.jpg}
        \caption{$u_2$ with $P^2$-elements}
        \label{fig:uniform_mesh_wave_sol_2_p2}
    \end{minipage}
\end{figure}