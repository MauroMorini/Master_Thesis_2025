%---Existence-------------------------------------------------------------------------
\section{Existence of Discrete Solution}
\label{sec:existence_uniqueness_elliptic_discrete_problem}
Firstly we will recall some basic definitions:
\begin{definition} Let $V$ be a normed vector space and $b:V\times V \to \mathbb{R}$
	be a bilinear form.
	\begin{enumerate}[label=\textnormal{(\roman*)}]
		\item We say $b$ is \textbf{continuous} if $\exists C_{\text{cont}}>0$, such that
		      \[
			      |b(u,v)|\leq C_{\text{cont}}\, \|u\|\, \|v\| \qquad \forall u,v \in V
		      \]
		\item We say $b$ is \textbf{symmetric} if
		      \[
			      b(u,v) = b(v,u) \qquad \forall u,v \in V
		      \]
		\item We say $b$ is \textbf{coercive} if $\exists C_{\text{coer}}>0$, such that
		      \[
			      b(u,u)\geq C_{\text{coer}}\, \|u\|^2 \qquad \forall u \in V
		      \]
	\end{enumerate}
\end{definition}


Since (\ref{eq:discrete_var_form_elliptic}) corresponds to the finite dimensional
system (\ref{eq:fully_discrete_dg_system_elliptic}) uniqueness and existence of a solution
are equivalent.
The bilinear form $b_h$ is \textit{symmetric} by construction
the goal of this section is to show that $b_h$ is also \textit{coercive} for $\sigma > 0$ big enough.
From the coercivity of $b_h$ it will follow that the matrix $\textbf{B}$ in (\ref{eq:fully_discrete_dg_system_elliptic})
is positive definite and hence invertible, which means there exists a (unique) solution
of (\ref{eq:discrete_var_form_elliptic}).
\begin{lemma}
	Let $V = \text{span}(\varphi_1,\ldots,\varphi_M)$ be a finite dimensional
	normed vector space with $\dim(V) = M\in \mathbb{N}$ and let
	$b:V \times V \to \mathbb{R}$ be a symmetric, coercive bilinear form,
	then the matrix ${[\textbf{B}]}_{i,j} = {[b(\varphi_j, \varphi_i)]}_{i,j}\in \mathbb{R}^{N\times N}$
	is symmetric positive definite.
\end{lemma}
\begin{proof}
	Clearly $\textbf{B}$ is symmetric. \\
	Let $\textbf{v}=(v_1,\ldots,v_M)\in \mathbb{R}^M$ then $v = \sum_{i=1}^{M}
		v_i \varphi_i\in V$ and we have:
	\[
		\textbf{v}^{T}\textbf{B}\textbf{v} = \sum_{i,j=1}^{M}v_i v_j b(\varphi_j,\varphi_i) = b(v,v) \geq
		C_{\text{coer}} \|w\|^2
	\]
	where we have used the biliniearity and the coercivity of $b$.
\end{proof}

\subsection{Trace Inequalities}
Here we recall what is in the theory called \textit{trace inequalities}, which are inequalities bounding a boundary norm with a norm over the whole domain.
In 1d this means estimating the absolute value of a function at a boundary node, by a norm over the whole interval, which simplifies the proofs a lot. 
Still let it be said here, that these kind of inequalities hold in higher dimensions as well. General results can for example be found in Ern \cite{diPietro2012}. \\
This subsection will contain two results, one for general $H^1$-functions and one for polynomials.
\\ \\
We start by considering the finite dimensional case, inspired by \cite{warburtonHesthaven2003ineq}.

\begin{lemma}[Discrete trace inequality]
	\label{lemma:inv_ineq}
	Let $r \geq 1$ be the polynomial degree,
	$a,b\in \mathbb{R}$ with $a<b$ and let $\mathcal{P}^r([a,b])$ denote the
	space of polynomials of degree $r$ defined on $[a,b]$. \\
	For any $v\in \mathcal{P}^r([a,b])$ we have:
	\begin{enumerate}[label=\textnormal{(\roman*)}]
		\item $\displaystyle |v(a)|^2 \leq \frac{{(r+1)}^2}{|b-a|}\|v\|_{L^2([a,b])}^2$
		\item $\displaystyle |v(b)|^2 \leq \frac{{(r+1)}^2}{|b-a|}\|v\|_{L^2([a,b])}^2$
	\end{enumerate}
\end{lemma}
\begin{proof}
	We will prove the statements first for the reference element $\hat{I} = [-1,1]$ and then
	use a scaling argument to show the general case by applying a simple substitution. \\
	\begin{proofstep}[Setup]
		We will make
		use of the Legendre orthonormal basis of $\mathcal{P}^r(\hat{I})$:
		Let $P_0,\ldots,P_r$ denote the Legegndre polynomials on  $\mathcal{P}^r(\hat{I})$.
		Recall the following well known facts (see for example \cite{quarteroniNumericalMathematicSpringer2007}):
		\begin{enumerate}
			\item $\{P_0,\ldots,P_r\}$ form an orthogonal basis of $\mathcal{P}^r(\hat{I})$ under the
			      $L^2(\hat{I})$ inner product. Meaning:
			      \[
				      \text{span}(P_0,\ldots,P_r) = \mathcal{P}^r(\hat{I}),\quad \int_{-1}^{1} P_i P_j \,\text{d}\xi =
				      \begin{cases}
					      \frac{2}{2i + 1}, & \text{for } i=j     \\
					      0,                & \text{for } i\neq j
				      \end{cases}
			      \]
			\item $P_i(1) = 1, P_i(-1) = {(-1)}^i, \qquad \forall i = 0,\ldots,r$
		\end{enumerate}
		Let $\psi_i = \sqrt{\frac{(2i + 1)}{2}}P_i$ for $i=0,\ldots,r$ denote the normed
		basis function. Clearly we now have
		\[
			\psi_i(-1) = {(-1)}^i\sqrt{\frac{2i+1}{2}}, \qquad \psi_i(1) = \sqrt{\frac{2i+1}{2}},
			\qquad \int_{-1}^{1}\psi_i \psi_j \text{d}\xi = \delta_{i,j}, \qquad \forall i = 0,\ldots,r
		\]
		where $\delta_{i,j} =
			\begin{cases}
				1, & \text{for } i = j   \\
				0, & \text{for } i\neq j
			\end{cases}$, and hence $\{\psi_0,\ldots,\psi_r\}$ form an orthonomal basis.
	\end{proofstep}
	\begin{proofstep}[Proof on reference element]
		For any $v\in \mathcal{P}^r(\hat{I})$
		there exist coefficients $v_0,\ldots,v_r \in \mathbb{R}$, such that
		$v = \sum_{i=0}^{r}v_i \psi_i$. By applying Cauchy-Schwarz we find
		\[
			|v(-1)|^2 = \Big|\sum_{i=0}^{r}v_i \psi_i(-1)\Big|^2 \leq \Big(\sum_{i=0}^{r} v_i^2 \Big)\Big(\sum_{i=0}^{r} \psi_i(-1)^2 \Big)
			= \Big(\sum_{i=0}^{r} v_i^2 \Big)\Big(\sum_{i=0}^{r} \frac{2i+1}{2} \Big)
			= \Big(\sum_{i=0}^{r} v_i^2 \Big)\frac{(r+1)^2}{2}
		\]
		and finally the orthonormality of the $\psi_i$ yields
		\[
			\frac{(r+1)^2}{2}\sum_{i=0}^{r} v_i^2  = \frac{(r+1)^2}{2}\sum_{i,j=0}^{r} v_i v_j \delta_{i,j}
			= \frac{(r+1)^2}{2} \|v\|_{L^2(\hat{I})}^2
		\]
		This yields the first inequality for the reference element. The second inequality
		can be proven analogously.
	\end{proofstep}
	\begin{proofstep}[Scaling argument]
		Now we assume that $v \in \mathcal{P}^r([a,b])$.
		Using the affine (element) map
		\[
			F:[-1,1] \to [a,b], \xi \mapsto \frac{a + b}{2} + \frac{|b-a|}{2}\xi
		\]
		we can pull $v$ back to the reference element by defining
		$\widehat{v}(\xi):=v(F(\xi))$ for all $\xi \in \hat{I}$.
		Clearly $\widehat{v} \in \mathcal{P}^r(\hat{I})$ hence, by Step 2 we obtain
		\[
			|v(a)|^2 = |\widehat{v}(F^{-1}(a))|^2 = |\widehat{v}(-1)|^2
			\leq \frac{(r+1)^2}{2}\int_{-1}^{1}\widehat{v}(\xi)^2 \text{d}\xi =
			\frac{(r+1)^2}{2}\frac{2}{|b-a|}\|v\|_{L^2([a,b])}^2
		\]
		where in the last equality we have applied a change of variable $x=F(\xi)$ to the integral.
		Applying the same line of reasoning to $|v(b)|^2$ proves both inequalities
		and so we are done.
	\end{proofstep}
	\\
\end{proof}

Next we consider the continuous case.
\begin{lemma}[Continuous trace inequality]
	\label{lemma:cont_trace_ineq}
	Let $I = (a,b) \subset \mathbb{R}$ be an element of length $h:= b-a$, then for any $v \in H^1(\Omega)$ 
	\begin{enumerate}[label=\textnormal{(\roman*)}]
		\item $\displaystyle |v(a)| \leq h^{-1/2} \|v\|_{L^2(I)} + h^{1/2} \|v'\|_{L^2(I)}; $
		\item $\displaystyle |v(b)| \leq h^{-1/2} \|v\|_{L^2(I)} + h^{1/2} \|v'\|_{L^2(I)}. $
	\end{enumerate} 
\end{lemma}
\begin{proof}
	We show (\romannumeral 1), the proof of (\romannumeral 2) is analogous. \\
	Define $\varphi (x) := 1- \frac{(x-a)}{h}$, where $\varphi (a) = 1, \varphi (b) = 0$ and let $v \in H^1(I)$. By applying the fundamental theorem of calculus we can estimate 
	\begin{align*}
		|v(a)| &= | v(a)\varphi(a) - v(b)\varphi(b) | = | \int_{I} (v \, \varphi )' \text{ d} x| 
		= | \int_{I} v'(x) \varphi(x) \text{ d} x + \int_{I} v(x) \varphi'(x) \text{ d} x | \\
		& \leq \int_{I} |v'(x)| \,\underbrace{|\varphi(x) |}_{\leq 1} \text{ d}x + \frac{1}{h} \int_{I} |v(x)| \text{ d} x,
	\end{align*}
	where in the last step we have used that $\displaystyle | \varphi ' (x)| =h^{-1}$. Using Cauchy-Schwarz we finally estimate
	\begin{align*}
		|v(a)| &\leq \Big( \int_{I} 1 \text{ d} x \Big)^{1/2} \Big( \int_{I} |v'(x)|^2 \text{ d} x \Big)^{1/2}
		+ \frac{1}{h} \Big( \int_{I} 1 \text{ d} x \Big)^{1/2} \Big( \int_{I} |v(x)|^2 \text{ d} x \Big)^{1/2} \\
		& \leq h^{1/2} \| v'\|_{L^2(I)} + h^{-1/2} \| v\|_{L^2(I)},
	\end{align*}
	which proves (\romannumeral 1). \\
\end{proof}

\medskip
Recall the in previous sections established notations, let $r\in \mathbb{N}$ denote the polynomial
degree and $V_h^r(\mathcal{T}_h)$ be the discrete subspace.
\begin{definition}
	We define the \textbf{energy norm} on $V_h$ by
	\begin{equation}
		\label{def:energy_norm}
		\|v\|_{\epsilon}^2 := \sum_{n=0}^{N} \int_{I_n} c(x)v'(x)^2\text{d}x + \sum_{n=0}^{N+1}{\normalfont\texttt{a}_n}[v(x_n)]^2
	\end{equation}
	where {\normalfont\texttt{a}} denotes the penalization term in (\ref{def:penalization_function}).
\end{definition}
\begin{lemma}
	\label{lemma:energy_norm_is_norm}
	$\|\cdot\|_{\epsilon}$ defines a norm on $V_h$.
\end{lemma}
\begin{proof}
	Clearly we have $\|\lambda v\|_{\epsilon} =|\lambda|\, \|v\|_{\epsilon}$ for all $\lambda \in \mathbb{R}, v\in V_h$. \\ \\
	By definition we have $\texttt{a}, c>0$ and by extension $\|v\|_{\epsilon} \geq 0$ for all
	$v\in V_h$. Suppose now that $\|v\|_{\epsilon} = 0$ for some $v\in V_h$, then we must have $v|_{I_n} \equiv \text{const}$
	and $[v(x_n)] = 0$ for all $n$. So $v$ must be constant on all elements and have a jump of zero at the element boundaries.
	These two facts combined imply that $v$ is constant on all of $\Omega$. By the definition of the jump
	at the boundary nodes of $\Omega$ it immediately follows that $v=0$. Clearly
	$\|0\|_{\epsilon}=0$, therefore $\|\cdot\|_{\epsilon}$ is positive definite. \\ \\
	Using $[v(x_n) + w(x_n)] = [v(x_n)] + [w(x_n)] \quad \forall v,w \in V_h, n = 0,\ldots,N+1$ we find
	\begin{align*}
		\|v+w\|_{\epsilon} & \leq \Big(\sum_{n=0}^{N} (\|\sqrt{c}v'\|_{L^2(I_n)}+\|\sqrt{c}w'\|_{L^2(I_n)})^2 +
		\sum_{n=0}^{N+1} (\sqrt{\texttt{a}_n}([v(x_n)] + [w(x_n)]))^2\Big)^{1/2}                       \\
		          & \leq \|v\|_{\epsilon} + \|w\|_{\epsilon}
	\end{align*}
	where in the last inequality we have used the triangle inequality of the euclidian vector norm on $\mathbb{R}^{2N+3}$, with the vector given
	as

	\[
		\textbf{v} = \big[\|\sqrt{c}v'\|_{L^2(I_0)},\ldots,\|\sqrt{c}v'\|_{L^2(I_N)}, \sqrt{\texttt{a}_0}[v(x_0)],\ldots,\sqrt{\texttt{a}_{N+1}}[v(x_{N+1})]\big]^T
	\]
	this shows the triangle inequality for $\|\cdot\|_{\epsilon}$ and hence it is a norm.
\end{proof}

\begin{theorem}
	\label{thr:cont_coerc_bilin_form}
	Let $r\in \mathbb{N}$, the bilinear form $b_h$ in (\ref{eq:discrete_var_form_elliptic}) is continuous
	on $V_h^r(\mathcal{T}_h)$ and if furthermore $\sigma \geq \frac{6 (r+1)^2 c_{\max} }{c_{\min}}$, $b_h$ is also
	coercive on $V_h^r(\mathcal{T}_h)$. 
	The coercivity and continuity constants are given by 
	\begin{equation*}
		C_{\text{coer}} = \frac{1}{2}, \qquad C_{\text{cont}} = (3 + \frac{5}{4} C_{\sigma}) 
	\end{equation*}
	where $C_{\sigma} = \frac{(r+1)^2 c_{\max} }{\sigma c_{\min}}$
\end{theorem}
\begin{proof}
	\begin{proofstep}[Coercivity]
		Let $w\in V_h$. Note that
		\begin{equation}
			\label{eq:coerc_thr_relation_bilin_form_with_norm}
			b_h(w,w) = \|w\|_{\epsilon}^2 - 2\sum_{n=0}^{N+1}\{c(x_n)w'(x_n)\}[w(x_n)]
		\end{equation}
		To derive the coercivity of $b_h$ we will estimate the term $2\sum_{n=0}^{N+1}\{c(x_n)w'(x_n)\}[w(x_n)]$
		from above applying Lemma \ref{lemma:inv_ineq} and additional smaller tools:\\
		Using Young's inequality: $2ab \leq a^2 + b^2, \forall a,b\in\mathbb{R}$, we estimate
		\begin{align}
			 & 2\sum_{n=0}^{N+1}\{c(x_n)w'(x_n)\}[w(x_n)] = 2\sum_{n=0}^{N+1}\{c(x_n)w'(x_n)\}
			\Big(\frac{\texttt{a}_n}{2}\Big)^{-1/2} \Big(\frac{\texttt{a}_n}{2}\Big)^{1/2} [w(x_n)]\nonumber \\
			 & \leq 2\sum_{n=0}^{N+1} \frac{\{c(x_n)w'(x_n)\}^2}{\texttt{a}_n}
			+ \frac{1}{2} \sum_{n=0}^{N+1} \texttt{a}_n [w(x_n)]^2 \label{eq:2_coerc_thr_first_estimate}
		\end{align}
		Recalling $\texttt{a}_n = \sigma \texttt{c}_n\texttt{h}_n^{-1}$ from (\ref{def:penalization_function}) and noting the relations
		$\texttt{h}_n \leq h_n, \texttt{c}_n^{-1} \leq c(x_n^-)^{-1}, c(x_n^+)^{-1}$ we find
		\begin{align*}
			 & \texttt{a}_n^{-1} c(x_n^+) \leq \frac{h_n}{\sigma}, \quad \texttt{a}_n^{-1} c(x_n^-) \leq \frac{h_{n-1}}{\sigma}, \quad \forall n=1,\ldots,N \\
			 & \texttt{a}_0^{-1} c(x_0^+) = \frac{h_0}{\sigma} , \quad \texttt{a}_{N+1}^{-1} c(x_{N+1}^-) = \frac{h_{N}}{\sigma}
		\end{align*}
		applying this and the usefull inequality $(a+b)^2 \leq 2a^2 + 2b^2$ yields
		\begin{align}
			\label{eq:coerc_thr_second_estimate}
			 & 2\sum_{n=0}^{N+1} \frac{\{c(x_n)w'(x_n)\}^2}{\texttt{a}_n} \nonumber        \\
			 & = 2\sum_{n=1}^{N} \frac{1}{4\texttt{a}_n}
			\Big( c(x_n^-)w'(x_n^-) + c(x_n^+)w'(x_n^+) \Big)^2 + \frac{2}{\texttt{a}_0} \Big( c(x_0^+)w'(x_0^+) \Big)^2
			+ \frac{2}{\texttt{a}_{N+1}} \Big( c(x_{N+1}^-)w'(x_{N+1}^-) \Big)^2 \nonumber \\
			 & \leq 2\sum_{n=1}^{N} \frac{1}{2\sigma}
			\Big( h_{n-1}c(x_n^-)w'(x_n^-)^2 + h_{n}c(x_n^+)w'(x_n^+)^2 \Big) + \frac{2h_0}{\sigma} c(x_0^+)w'(x_0^+)^2
			+ \frac{2h_{N}}{\sigma} c(x_{N+1}^-)w'(x_{N+1}^-)^2 \nonumber                  \\
			 & \leq \frac{c_{\max}}{\sigma}\sum_{n=1}^{N}
			\Big(h_{n-1}w'(x_n^-)^2 + h_{n}w'(x_n^+)^2 \Big) + \frac{2c_{\max}h_0}{\sigma} w'(x_0^+)^2
			+ \frac{2c_{\max}h_{N}}{\sigma} w'(x_{N+1}^-)^2
		\end{align}
		Since $w\in V_h$ is a (broken) polynomial, we can apply Lemma \ref{lemma:inv_ineq} elementwise and find
		\begin{equation}
			\label{eq:coerc_thr_application_inverse_estimate}
			w'(x_n^+)^2,w'(x_{n+1}^-)^2  \leq \frac{(r+1)^2}{h_n} \|w'\|_{L^2(I_n)}^2 \quad \forall n = 0,\ldots,N
		\end{equation}
		By combining (\ref{eq:coerc_thr_second_estimate}), (\ref{eq:coerc_thr_application_inverse_estimate}) and
		inserting $1 = c_{\min}c_{\min}^{-1} \leq c(x)c_{\min}^{-1} \quad \forall x\in\Omega$ we find
		\begin{equation}
			\label{eq:coerc_thr_last_estimate}
			2\sum_{n=0}^{N+1} \frac{\{c(x_n)w'(x_n)\}^2}{\texttt{a}_n} \leq
			3C_{\sigma} \sum_{n=0}^{N} \|\sqrt{c}w'\|_{L^2(I_n)}^2
		\end{equation}
		for $\displaystyle C_{\sigma} := \frac{ (r+1)^2 c_{\max} }{\sigma c_{\min}} > 0$. \\ \\
		Finally putting together (\ref{eq:coerc_thr_relation_bilin_form_with_norm}), (\ref{eq:2_coerc_thr_first_estimate}) and
		(\ref{eq:coerc_thr_last_estimate}) yields
		\begin{align*}
			b_h(w,w) & \geq \|w\|_{\epsilon}^2 - 3C_{\sigma} \sum_{n=0}^{N} \|\sqrt{c}w'\|_{L^2(I_n)}^2
			- \frac{1}{2} \sum_{n=0}^{N+1} \texttt{a}_n [w(x_n)]^2 \nonumber                                                                           \\
			         & = (1 - 3C_{\sigma}) \sum_{n=0}^{N} \|\sqrt{c}w'\|_{L^2(I_n)}^2 + \frac{1}{2} \sum_{n=0}^{N+1} \texttt{a}_n [w(x_n)]^2 \nonumber \\
			         & \geq \frac{1}{2} \|w\|_{\epsilon}^2
		\end{align*}
		for $\sigma \geq \frac{6 (r+1)^2 c_{\max} }{c_{\min}}$, which proves the coercivity
		of $b_h$ on $V_h$.
	\end{proofstep}
	\\
	\begin{proofstep}[Continuity]
		The proof the continuity of $b_h$ uses similar ideas as the coercivity proof. Let
		$u,v \in V_h$, by using Cauchy-Schwarz we
		immediately get
		\begin{align}
			|b_h(u,v)| & \leq \sum_{n=0}^{N} \|\sqrt{c}u'\|_{L^2(I_n)} \|\sqrt{c}v'\|_{L^2(I_n)}
			+  \sum_{n=0}^{N+1} \big| \{c(x_n)u'(x_n)\}[v(x_n)] \big| \nonumber                               \\
			           & +\sum_{n=0}^{N+1} \big|\{c(x_n)v'(x_n)\}[u(x_n)]\big|
			+\sum_{n=0}^{N+1} \texttt{a}_n \big|[u(x_n)][v(x_n)]\big| \nonumber                               \\
			           & =: T_{\text{ell}} + T_{\text{cons}}^{(u)} + T_{\text{cons}}^{(v)} + T_{\text{penal}}
			\label{eq:cont_thr_estimate_elliptic_part}
		\end{align}
		The goal is now to estimate the consistency terms $T_{\text{cons}}$ from above by something of the form
		$ \sum_{n=0}^{N+1} t_n(u) s_n(v) + \sum_{n=0}^{N+1} t_n(v) s_n(u)$, such that together with the terms
		$T_{\text{ell}}, T_{\text{penal}}$ we can use discrete Cauchy-Schwarz on the sums and hence separate them into
		a product of the two energy norms $C_{\text{cont}} \|u\|_{h}\|v\|_{h} $ scaled by a positive constant. \\ \\
		We will show the estimate of $T_{\text{cons}}^{(u)}$, the procedure to estimate $T_{\text{cons}}^{(v)}$ is analogous. \\
		First rewrite
		\begin{equation}
			\label{eq:continuity_thr_consistency_term}
			T_{\text{cons}}^{(u)} = \sum_{n=0}^{N+1} \big| \{c(x_n)u'(x_n)\} \texttt{a}_n^{-1/2}\texttt{a}_n^{1/2} [v(x_n)] \big|
		\end{equation}
		Next again using the definition of $\texttt{a}$ and estimates as in Step 1 we find for interior faces $n = 1,\ldots,N$
		\begin{equation}
			\big|\{c(x_n)u'(x_n)\}\big|\texttt{a}_n^{-1/2}
			\leq \frac{1}{2} \sqrt{\frac{\texttt{h}_n}{\sigma}} \sqrt{c_{\max}}
			\left( |u'(x_n^-)| + |u'(x_n^+)| \right) \nonumber
		\end{equation}
		and for the boundary faces
		\begin{equation}
			\big|\{c(x_0)u'(x_0)\}\big|\texttt{a}_0^{-1/2}
			\leq \sqrt{\frac{\texttt{h}_0}{\sigma}} \sqrt{c_{\max}}
			|u'(x_0^+)|,
			\quad \big|\{c(x_{N+1})u'(x_{N+1})\}\big|\texttt{a}_{N+1}^{-1/2}
			\leq \sqrt{\frac{\texttt{h}_{N}}{\sigma}} \sqrt{c_{\max}}
			|u'(x_{N+1}^-)| \nonumber
		\end{equation}
		Applying Lemma (\ref{lemma:inv_ineq}) yields for
		$\displaystyle \beta_n(u) := \sqrt{C_{\sigma}} \|\sqrt{c}u'\|_{L^2(I_{n})}, n=0,\ldots,N$
		\begin{align*}
			 & \big|\{c(x_n)u'(x_n)\}\big|\texttt{a}_n^{-1/2} \leq \frac{\beta_{n-1}(u)}{2}
			+ \frac{\beta_n(u)}{2}  \quad \text{for } n=1,\ldots,N                          \\
			 & \big|\{c(x_0)u'(x_0)\}\big|\texttt{a}_0^{-1/2} \leq \beta_0(u)               \\
			 & \big|\{c(x_{N+1})u'(x_{N+1})\}\big|\texttt{a}_{N+1}^{-1/2} \leq \beta_{N}(u) \\
		\end{align*}
		which we can now plug back into (\ref{eq:continuity_thr_consistency_term}) to get
		\begin{align}
			T_{\text{cons}}^{(u)}
			\leq \beta_0(u)\gamma_0(v) + \beta_{N}(u)\gamma_{N+1}(v)
			 & + \sum_{n=1}^{N} \frac{\beta_{n-1}(u)}{2} \gamma_{n} (v)+ \sum_{n=1}^{N} \frac{\beta_{n}(u)}{2} \gamma_n(v)
		\end{align}
		for $\displaystyle \gamma_n(v) := \sqrt{\texttt{a}_n}\big|[v(x_n)]\big| \, \forall n=0,\ldots,N+1$.
		By furthermore denoting $ \alpha_n(u):= \|\sqrt{c}u'\|_{L^2(I_n)}$
		we can represent

		\begin{equation*}
			T_{\text{ell}} = \sum_{n=0}^{N}\alpha_n(u)\alpha_n(v),\qquad
			T_{\text{penal}} = \sum_{n=0}^{N+1}\gamma_n(u)\gamma_n(v)
		\end{equation*}
		and in total for
		\begin{align*}
			 & \textbf{u}:= [ \alpha_0(u),\ldots,\alpha_{N}(u),\beta_0(u), \beta_{N}(u),\frac{\beta_{0}(u)}{2},\ldots, \frac{ \beta_{N-1}(u)}{2}, \frac{\beta_{1}(u)}{2},\ldots,\frac{\beta_{N}(u)}{2},                            \\
			 & \qquad \quad \gamma_{0}(u), \gamma_{N+1}(u), \gamma_{1}(u),\ldots,\gamma_{N}(u), \gamma_{1}(u),\ldots,\gamma_{N}(u),
			\gamma_0(u),\ldots,\gamma_{N+1}(u)]^T \in \mathbb{R}^{6N + 7}                                                                                                                                                          \\
			 & \textbf{v}:= [ \alpha_0(v),\ldots,\alpha_{N}(v), \gamma_{0}(v), \gamma_{N+1}(v), \gamma_{1}(v),\ldots,\gamma_{N}(v),
			\gamma_{1}(v),\ldots,\gamma_{N}(v),                                                                                                                                                                                    \\
			 & \qquad \quad \beta_0(v), \beta_{N}(v),\frac{\beta_{0}(v)}{2},\ldots,\frac{\beta_{N-1}(v)}{2}, \frac{\beta_{1}(v)}{2},\ldots,\frac{\beta_{N}(v)}{2}, \gamma_{0}(v),\ldots,\gamma_{N+1}(v)]^T \in \mathbb{R}^{6N + 7}
		\end{align*}
		we get
		\begin{align*}
			 & T_{\text{ell}} + T_{\text{cons}}^{(u)} + T_{\text{cons}}^{(v)} + T_{\text{penal}} \leq \textbf{u}^T \textbf{v}
			\leq |\textbf{u}|\, |\textbf{v}|                                                                                                          \\
			 & \leq \Big( \sum_{n=0}^{N}(1+\frac{5}{4}C_{\sigma}) \|\sqrt{c}u'\|_{L^2(I_n)}^2 + 3 \sum_{n=0}^{N+1} \texttt{a}_n [u(x_n)]^2\Big)^{1/2}
			\Big( \sum_{n=0}^{N}(1+\frac{5}{4}C_{\sigma}) \|\sqrt{c}v'\|_{L^2(I_n)}^2 + 3 \sum_{n=0}^{N+1} \texttt{a}_n [v(x_n)]^2\Big)^{1/2}         \\
			 & \leq C_{\text{cont}}\|u\|_{\epsilon} \|v\|_{\epsilon}
		\end{align*}
		where $\displaystyle C_{\text{cont}} := (3+\frac{5}{4}C_{\sigma})$. This last estimate together with
		\ref{eq:cont_thr_estimate_elliptic_part} proves the continuity of $b_h$.
	\end{proofstep}
\end{proof}

% Extension of the Bilinear form -----------------------------------------------------------------------------------------------------------------------------------------
\section{Extension of the Bilinear Form}
To simplify the theory we will continue to assume the exact solution to be in $H^2(\Omega)$. 
When we intend to extend the bilinear form from $V_h$ to a bigger space which contains the exact solution we run into the problem, that $V_h \not \subset H^1(\Omega)$, 
by extension we also have $V_h \not \subset H^2(\Omega)$. So in contrast to continuous FEM we have to use a bigger space allowing for discontinuities and including both 
$V_h$ and $H^2(\Omega)$. \\
A very common approach (see for example \cite{georgoulis2011Springer}) is to choose a vector space sum 

\begin{equation}
    \label{def:V_sum}
    V:= V_h + H^2(\Omega) = \{ v \in L^2(\Omega) \, |\, v = v_h + \tilde{v}, \text{ for } v_h \in V_h, \tilde{v} \in H^2(\Omega)\}
\end{equation}
Alternatively Rivière proposes the usage of \textit{broken Sobolev spaces} in \cite{riviere2008}. That is, for a given partition $\mathcal{T}_h$ of $\Omega$ 
we can define 
\begin{equation*}
    H^k(\mathcal{T}_h) := \{ v \in L^2(\Omega) \,| \, v \vert_I \in H^k(I), \forall I \in \mathcal{T}_h \}
\end{equation*} 
for some $k \in \mathbb{N}_0$, this allows for discontinuities and we have $V_h \in H^2(\mathcal{T}_h)$. We will use $V$ as defined in (\ref{def:V_sum}).
Now we extend the bilinear form $b_h$ and the linear functional $\ell_h$ from $V_h$ to $V$ and formally get

\begin{tcolorbox}[mythmstyle]
    \begin{equation}
        \label{def:sipg_bilin_form_extended}
        b: V \times V \to \mathbb{R}, \qquad \ell: V  \to \mathbb{R}
    \end{equation}
	where
	\begin{align*}
		b(u,v) & = \sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
		-\sum_{n=0}^{N+1} \{c(x_n)u'(x_n)\}[v(x_n)] + \{c(x_n)v'(x_n)\}[u(x_n)]
		+\sum_{n=0}^{N+1} \texttt{a}_n[u(x_n)][v(x_n)]                                     \\
		\ell(v)  & = (f,v)_{L^2(\Omega)}-g_1c(x_{N+1}^-)v'(x_{N+1}^-) + g_0c(x_0^+)v'(x_0^+)
		+ \texttt{a}_{N+1}g_1v(x_{N+1}^-) + \texttt{a}_0 g_0v(x_{0}^+)
	\end{align*}
	for $u,v\in V$.
\end{tcolorbox}
\noindent This yields the SIPG variational formulation \\ 
Find $u \in V$ such that: 
\begin{equation}
    \label{eq:elliptic_sipg_var_form_extended}
    b(u, v) = \ell(v), \qquad \forall v\in V
\end{equation}
Furthermore we extend the energy norm $\| \cdot \|_{\epsilon}$ as presented in (\ref{def:energy_norm}) to $V$. Note that this still defines a norm, since in 
lemma \ref{lemma:energy_norm_is_norm} we never explicitly need the finite dimensionality of $V_h$. \\

\subsubsection*{Lower Regularity Solutions}
The $H^2$-regularity assumption on the solution is a common one in the context of convergence theory, but still a rather strict one in general. 
If we assume only $H^1$-regularity, which is a reasonable assumption to make, we encounter the problem of undefined trace values. Recall that 
from the trace theorem it is known that $L^2$-regularity is not enough to yield uniquely defined trace values. In 1d this becomes apparent, since 
point values of $L^2$-functions are not well defined. In particular for a solution $u \in H^1(\Omega)$, we have that $u'(x_n^+), u'(x_n^-)$ 
are not well defined. Extending the bilinear form $b_h$ to $V$ requires some additional work, which is often done in one of two ways:
\begin{enumerate}
    \item Lifting operators	(see \cite{grote2006})
    \item $L^2$-projection	(see \cite{georgoulis2011Springer})
\end{enumerate}
We will completely circumvent this issue by assuming $H^2$-regularity. \\ \\
Recall that in the proof of Theorem \ref{thr:cont_coerc_bilin_form} for coercivity and continuity of the bilinear form we have used the finite 
dimensionality of the polynomial spaces over each element in $\mathcal{T}_h$. This means that the coercivity and continuity properties cannot be simply 
applied to our extended form $b$. For this we would have to introduce either lifting or the $L^2$-projection as mentioned before.

\subsection{Consistency of the SIPG Variational Formulation}
The final matrix-vector system we solve (yielding our numerical solution) is equivalent to the fully 
discrete variational formulation (\ref{eq:discrete_var_form_elliptic}), which in turn is a discretization of not the original weak problem 
(\ref{eq:elliptic_weak_form}), but rather the SIPG variational formulation (\ref{eq:elliptic_sipg_var_form_extended}).
We now have to show, that any solution of the SIPG variational formulation is also a solution of the original weak problem and vice versa to ensure 
our Galerkin approximation approximates the wanted exact solution, i.e.\@ that the SIPG variational formulation is consistent with the weak 
formulation of the problem.

\begin{theorem}
	\label{thr:elliptic_consistency_sipg_variational_formulation}
	The SIPG variational formulation is consistent. That is, for $u \in H^2(\Omega)$ we have: \\
	$u$ is a solution of (\ref{eq:elliptic_weak_form}) if and only if $u$ solves (\ref{eq:elliptic_sipg_var_form_extended})
\end{theorem}
\begin{proof}
	\begin{proofstep}["$\Leftarrow$"]
		\noindent First suppose $u\in H^2(\Omega)$ is a solution of the SIPG variational formulation (\ref{eq:elliptic_sipg_var_form_extended}), then clearly 
		\begin{equation}
			\label{eq:proof_consistency_ell_var_form_1}
			b(u,v) = \ell(v) \qquad \forall v \in C_c^{\infty}(\Omega) \subset H^2(\Omega)
		\end{equation}
		since $u,v$ are continuous we have 
		\begin{equation*}
		[u(x_n)] = [v(x_n)] = 0 \qquad  \forall n \in \{1,\ldots,N\}	
		\end{equation*}
		and $v \in C_c^{\infty}(\Omega)$ implies 
		\begin{equation*}
		[v(x_0)] = [v(x_{N+1})] = \{c(x_0)v^{\prime}(x_0)\} = \{c(x_{N+1})v^{\prime}(x_{N+1})\} = 0	
		\end{equation*}
		therefore (\ref{eq:proof_consistency_ell_var_form_1}) becomes
		\begin{equation}
			\label{eq:proof_consistency_ell_var_form_weak_form}
			a(u,v) = (f,v)_{L^2(\Omega)} \qquad \forall v \in C_c^{\infty}(\Omega)
		\end{equation}
		where $a$ is the elliptic bilinear form of the weak formulation in (\ref{eq:elliptic_weak_form}). \\
		Now to recover the boundary conditions first note that since $u \in H^2(\Omega)$ and  $u$ satisfies (\ref{eq:proof_consistency_ell_var_form_weak_form}) 
		we have 
		\begin{equation}
			\label{eq:proof_consistency_ell_var_form_a_e_form}
			-(c\, u')' = f \qquad \text{a.e.\@ in } \Omega  
		\end{equation}
		From here we follow exactly the derivation of the discrete SIPG variational formulation in section \ref{sec:elliptic_var_form}.
		We multiply (\ref{eq:proof_consistency_ell_var_form_a_e_form}) by a test function $v \in V$, integrate over the elements $I \in \mathcal{T}_h$ by parts, 
		sum up over all elements and add the symmetry and penalty terms corresponding to the SIPG bilinear form, hence we find
		\begin{equation}
			\label{eq:proof_consistency_ell_var_form_b_c}
			b(u,v) = (f,v)_{L^2(\Omega)} - c(x_{N+1}^-)u(x_{N+1}^-)v'(x_{N+1}^-) + c(x_{0}^+)u(x_{0}^+)v'(x_{0}^+) 
			+ \texttt{a}_{N+1}u(x_{N+1}^-)v(x_{N+1}^-) + \texttt{a}_0 u(x_{0}^+)v(x_{0}^+)
		\end{equation}
		Subtracting (\ref{eq:proof_consistency_ell_var_form_b_c}) from (\ref{eq:elliptic_sipg_var_form_extended}) yields
		\begin{equation*}
			\Big(-c(x_{N+1}^-)v'(x_{N+1}^-) + \texttt{a}_{N+1}v(x_{N+1}^-)\Big)\Big(u(x_{N+1}^-) - g_1\Big) 
			+ \Big(c(x_{0}^+)v'(x_{0}^+) + \texttt{a}_{0}v(x_{0}^+)\Big)\Big(u(x_{0}^+) - g_0\Big) = 0
		\end{equation*}
		Since the above equality holds for any $v \in V$ we can choose fitting test functions $v$ to show that $u$ satisfies the boundary conditions.
	\end{proofstep}
	\begin{proofstep}
		\noindent Now suppose $u \in H^2(\Omega) $ is a solution of the weak problem (\ref{eq:elliptic_weak_form}), as already argued in Step 1 we have 
		\begin{equation}
			-(c\, u')' = f \qquad \text{a.e.\@ in } \Omega  \nonumber
		\end{equation}
		this yields 
		\begin{equation}
			b(u,v) = (f,v)_{L^2(\Omega)} - c(x_{N+1}^-)u(x_{N+1}^-)v'(x_{N+1}^-) + c(x_{0}^+)u(x_{0}^+)v'(x_{0}^+) 
			+ \texttt{a}_{N+1}u(x_{N+1}^-)v(x_{N+1}^-) + \texttt{a}_0 u(x_{0}^+)v(x_{0}^+) \nonumber
		\end{equation}
		by the derivation steps recalled in Step 1. Applying the boundary conditions, which are fixed by the weak formulation (\ref{eq:elliptic_weak_form}), shows
		that $u$ indeed satisfies the SIPG variational formulation
		(\ref{eq:elliptic_sipg_var_form_extended}) and we are done. \\ \\
	\end{proofstep}
\end{proof}

\section{Error Analysis}
In this section we analyze the error between the Galerkin approximation resulting from the discrete SIPG formulation and an exact solution. 
We will focus on the error in the energy norm $\| \cdot \|_{h}$ but also mention the resulting error measured in the $L^2$-norm.
\\ \\
We start by recalling an important polynomial approximation result for finite elements. \\
Fix a polynomial degree $r \geq 1$ and let $I = (a, b) \subset \mathbb{R}$ be an element of length $h = b-a$. We denote the linear interpolation operator by
\begin{equation}
	\mathcal{I}_h^r : L^2(I) \to \mathcal{P}^r(I),
\end{equation}
where the distinct interpolation nodes are $\xi_0,\ldots,\xi_r \in I$. For our purpose the exact positioning of these nodes can be arbitrary. 
For readability if the context allows it we will denote the $i$-th derivative of a function $v$ by $\frac{\text{d}^i}{\text{d} x^i} v = v^{(i)}$.
\begin{lemma}[Interpolant estimate]
	\label{lemma:interp_estimate}
	Let $v \in H^{r+1}(I)$, it holds that 
	\begin{equation*}
		| v - \mathcal{I}_h^r v |_{H^m(I)} \leq  h^{r+1-m} |v|_{H^{r+1}(I)} \qquad \forall m \in \{0,\ldots,r+1\}
	\end{equation*} 
	where $|v|_{H^{r+1}(I)} = \| v^{({r+1})} \|_{L^2(I)}$ denotes the $H^{r+1}$-seminorm. \\ 
\end{lemma}
\begin{proof}

		Fix $m \in \{0,\ldots,r\}$, we start by first proving the $H^m$-seminorm
		\begin{equation}
			\label{eq:proof_polynomial_interpolation_approx_estimate_seminorm}
			| v - \mathcal{I}_h^r v |_{H^m(I)} \leq h^{r+1-m} |v|_{H^{r+1}(I)}
		\end{equation} 
		Define $e := v - \mathcal{I}_h^r v \in H^{r+1}(I) \subset C^{r}(I)$, by construction of the interpolation operator we have $e(\xi_i) = 0$ for 
		all $i \in \{0,\ldots,r\}$, where the $\xi_i$ are the interpolation nodes. \\
		By applying Rolle's theorem in succession we can find $r$ zeroes of $e'$, $r-1$ zeroes of $e''$$,\ldots,$ and one zero of $e^{(r)}$.
		Clearly in total there exist some points $y_0,\ldots,y_{r} \in I$ such that 
		\begin{equation*}
			e^{(i)}(y_i) = 0 \qquad \forall i \in \{0,\ldots,r\}.
		\end{equation*} 
		Next we use the fundamental theorem of calculus inductively, let $x_m \in I$ arbitrary and write
		\begin{align*}
			e^{(m)}(x_m) &= \underbrace{e^{(m)}(y_m)}_{=0} + \int_{y_m}^{x_m} e^{(m+1)}(x_{m+1}) \text{ d}x_{m+1} \\
			&= \underbrace{\int_{y_m}^{x_m} e^{(m+1)}(y_{m+1}) \text{ d}x_{m+1}}_{=0} 
			+\int_{y_m}^{x_m} \int_{y_{m+1}}^{x_{m+1}} e^{(m+2)}(x_{m+2}) \text{ d}x_{m+1} \text{ d}x_{m+2} \\
			= \cdots &= \underbrace{\int_{y_m}^{x_m}\cdots \int_{y_{r-1}}^{x_{r-1}} e^{(r)}(y_{r}) \text{ d}x_{r} \cdots \text{ d}x_{m+1}}_{=0}
			+ \int_{y_m}^{x_m}\cdots \int_{y_{r}}^{x_{r}} e^{(r+1)}(x_{r+1}) \text{ d}x_{r+1} \cdots \text{ d}x_{m+1}.
		\end{align*}
		Squaring both sides of this equation and integrating over $I$ yields
		\begin{align*}
			\| e^{(m)} \|_{L^2(I)}^2 &= 
			\int_{I} \Big(\int_{y_m}^{x_m}1 \cdot \int_{y_{m+1}}^{x_{m+1}}\cdots \int_{y_{r}}^{x_{r}} e^{({r+1})}(x_{{r+1}}) 
			\text{ d}x_{{r+1}} \cdots \text{ d}x_{m+2} \text{ d}x_{m+1}\Big)^2 \text{ d}x_{m} \\
			& \leq \int_{I} \underbrace{|x_{m} - y_{m} |}_{\leq h} \int_{y_m}^{x_m} \Big(\int_{y_{m+1}}^{x_{m+1}}\cdots \int_{y_{r}}^{x_{r}} e^{({r+1})}(x_{{r+1}}) 
			\text{ d}x_{r+1} \cdots \text{ d}x_{m+2} \Big)^2 \text{ d}x_{m+1} \text{ d}x_{m} \\
			& \leq h \int_{I}  \int_{I} \Big(\int_{y_{m+1}}^{x_{m+1}}\cdots \int_{y_{r}}^{x_{r}} e^{(r+1)}(x_{r+1}) 
			\text{ d}x_{r+} \cdots \text{ d}x_{m+2} \Big)^2 \text{ d}x_{m+1} \text{ d}x_{m} \\
			& \leq h^2 \int_{I} \Big(\int_{y_{m+1}}^{x_{m+1}}\cdots \int_{y_{r}}^{x_{r}} e^{(r+1)}(x_{r+1}) 
			\text{ d}x_{r+1} \cdots \text{ d}x_{m+2} \Big)^2 \text{ d}x_{m+1} \\
			\leq \cdots & \leq h^{2(r+1-m)} \int_{I} |e^{(r+1)}(x_{r+1})|^2 \text{ d}x_{r+1} = h^{2(r+1-m)} |e|_{H^{r+1}(I)}^2,
		\end{align*}
		where we have applied Cauchy-Schwarz inductively. 
		But now since $\mathcal{I}_h^r v \in \mathcal{P}^r(I) $ it holds that $ (\mathcal{I}_h^r v)^{(r+1)} \equiv 0$ in $I$, which implies that $e^{(r+1)} = v^{(r+1)}$ 
		and therefore $ |e|_{H^{r+1}}^2 = |v|_{H^{r+1}}^2 $.
		This proves (\ref{eq:proof_polynomial_interpolation_approx_estimate_seminorm}). \\
		Since we have proven (\ref{eq:proof_polynomial_interpolation_approx_estimate_seminorm}) for an arbitrary $m \in \{0,\ldots,r\}$ we can conclude that 
		\begin{equation*}
			| v - \mathcal{I}_h^r v |_{H^m(I)} \leq h^{r+1-m} |v|_{H^{r+1}(I)} \qquad \forall m \in \{0,\ldots,r\}.
		\end{equation*}
		If $m = r+1$ then we immediately have $ | v - \mathcal{I}_h^r v |_{H^m(I)} = | v  |_{H^{r+1}(I)} $. \\
\end{proof}

Suppose $u \in V$ satisfies the SIPG variational formulation (\ref{eq:elliptic_sipg_var_form_extended}) and 
$u_h \in V_h$ satisfies the discrete SIPG variational formulation (\ref{eq:discrete_var_form_elliptic}) (here the polynomial degree does not matter),  
then since $V_h \subset V$ it holds that 
\begin{equation}
	\label{eq:galerkin_orthogonality}
	b(u - u_h, v) = 0 \qquad \forall v \in V_h.
\end{equation}
This is commonly known as \textit{Galerkin orthogonality}. \\
We will now estimate the error of the Galerkin approximation in reference to the continuous solution. To do so recall the following setup. \\ \\
Let $r \geq 1$ be a polynomial degree, $\mathcal{T}_h = \{I_n\}_{n=0}^{N_h}$, be a partition of $\Omega$ with meshsize 
$ h = \max_{n \in \{0,\ldots,N_h\}} h_n > 0$, where $h_n = |x_{n+1} - x_n |$ and $I_n = (x_{n}, x_{n+1})$ for 
$n=0,\ldots,N_h$.
\begin{definition}
	We define the linear interpolation operator 
	\begin{eqnarray*}
		\mathcal{I}_h^r : C^{0}(\Omega) \to V_h^r(\mathcal{T}_h) \cap C^0(\Omega),
	\end{eqnarray*}
	such that the face nodes $x_n$ are interpolated for all $n \in \{0,\ldots,N_h\}$, i.e.\@ for $v \in C^0(\Omega)$ we have
	\begin{align*}
		\mathcal{I}_h^r v (x_n^-) &= v(x_n) \qquad \forall n \in \{1,\ldots,N_h +1 \}, \\
		\mathcal{I}_h^r v (x_n^+) &= v(x_n) \qquad \forall n \in \{0,\ldots,N_h \}.
	\end{align*}
	Note that for $r > 2$ we require $r-1$ additional interpolation nodes in each element $I \in \mathcal{T}_h$ besides the two element boundary nodes, for our purpose these 
	can be arbitrary as long as they are distinct. 
\end{definition}
\begin{theorem}[Convergence in energy norm]
	\label{thr:elliptic_energy_convergence}
	Let $\sigma > 0$ big enough, such that the SIPG bilinear form is coercive on $V_h^r(\mathcal{T}_h)$.
	Let $u \in H^{r+1}(\Omega)$ be a solution of the SIPG variational formulation (\ref{eq:elliptic_sipg_var_form_extended}) and $u_h \in V_h^r(\mathcal{T}_h)$ be its
	Galerkin approximation, i.e.\@ the solution of (\ref{eq:discrete_var_form_elliptic}). \\
	Then there exists a constant $C_{\epsilon}(C_{\text{coer}}, c_{\max}, \sigma) > 0$ independent of the meshsize $h$ and the solution $u$, such that 
	\begin{equation}
		\label{eq:elliptic_energy_convergence_rate}
		\|u - u_h \|_{h} \leq C_{\epsilon} h^{r} \, |u|_{H^{r+1}(\Omega)}.
	\end{equation}
	
\end{theorem}
\begin{remark} 
	\begin{enumerate}
		\item The regularity assumption on the solution $u$ is essential, if $u$ is of lower regularity than the polynomial degree, then the optimal convergence rate is not achieved. 
		\item Recall $c_{\max}$ is the maximum of the coefficient $c$ in the pde (\ref{eq:elliptic_pde}) and $C_{\text{coer}}$ is the coercivity constant from theorem \ref{thr:cont_coerc_bilin_form}.
	\end{enumerate}
\end{remark}
\begin{proof}
	\begin{proofstep}
		We interpolate the solution $u$ and shall for readability write $\mathcal{I}_h^r u = \mathcal{I}_h u \in V_h$. By the triangle inequality we can estimate
		\begin{equation}
			\label{eq:proof_triangle_ineq_energy_conv_elliptic}
			\| u - u_h \|_{\epsilon} \leq \|u - \mathcal{I}_h u \|_{\epsilon} + \|\mathcal{I}_h u - u_h \|_{\epsilon}.
		\end{equation}
		By the construction of the interpolant we know that $[ (u- \mathcal{I}_h u)(x_n)] = 0$ for all $n\in \{0,\ldots,N_h+1\}$, so the first term of 
		(\ref{eq:proof_triangle_ineq_energy_conv_elliptic}) becomes
		\begin{align}
			\|u - \mathcal{I}_h u \|_{\epsilon} &\leq \|\sqrt{c}(u - \mathcal{I}_h u)' \|_{L^2(\Omega)} \leq \sqrt{c_{\max}} \Big( \sum_{n=0}^{N_h} |u - \mathcal{I}_h u|_{H^1(I_n)}^2 \Big)^{1/2} \nonumber \\
			&\leq \sqrt{c_{\max}}\, h^{r} \Big( \sum_{n=0}^{N_h} |u |_{H^{r+1}(I_n)}^2 \Big)^{1/2} = \sqrt{c_{\max}}\, h^{r} \, |u |_{H^{r+1}(\Omega)}, \label{eq:proof_elliptic_energy_conv_first_term}
		\end{align}
		where in the last inequality we have used the interpolant estimate (lemma \ref{lemma:interp_estimate}).
	\end{proofstep}
	\begin{proofstep}
		Only the second term of (\ref{eq:proof_triangle_ineq_energy_conv_elliptic}) remains to be estimated. Define $e_h := u_h - \mathcal{I}_h u \in V_h$ and note that
		\begin{equation*}
			b(e_h, e_h) = \underbrace{b(u_h - u, e_h)}_{= 0} + \, b(u - \mathcal{I}_h u, e_h),
		\end{equation*}
		by Galerkin orthogonality (\ref{eq:galerkin_orthogonality}). Using the coercivity of the bilinear form $b$ on $V_h$ we can estimate 
		\begin{align*}
			C_{\text{coer}} \|e_h\|_{h}^2 &\leq b(e_h, e_h) = b(u - \mathcal{I}_h u, e_h) \\
			&= \Big| \underbrace{\sum_{n=0}^{N_h} \int_{I_n} c \,(u - \mathcal{I}_h u)' \, e_h' \text{ d} x }_{=: T_1}
			- \underbrace{\sum_{n=0}^{N_h + 1} \{c(x_n) (u - \mathcal{I}_h u)'(x_n) \} [e_h(x_n)]}_{=: T_2}  \\
			&- \sum_{n=0}^{N_h + 1} \{c(x_n) e_h^{\prime}(x_n)\}\underbrace{[(u - \mathcal{I}_h u)(x_n)]}_{=0} 
			+ \sum_{n=0}^{N_h + 1} \texttt{a}_n \underbrace{[(u - \mathcal{I}_h u)(x_n)]}_{=0} [e_h(x_n)] \Big| \\
			& = | T_1 - T_2 |. 
		\end{align*}
		We first estimate $|T_1| $, using Cauchy-Schwarz and Young's inequality: $ ab \leq \frac{a^2}{2 \varepsilon} + \frac{b^2 \varepsilon}{2}$, for $a,b \in \mathbb{R}, \varepsilon > 0$, 
		we find
		\begin{align*}
			|T_1| &\leq \sqrt{c_{\max}} \, \sum_{n=0}^{N_h} |u - \mathcal{I}_h u|_{H^1(I_n)} \| \sqrt{c}\, e_h' \|_{L^2(I_n)} 
			& \leq  \sqrt{c_{\max}} \, \Big( \sum_{n=0}^{N_h} |u - \mathcal{I}_h u|_{H^1(I_n)}^2 \Big)^{1/2} 
			\underbrace{\Big( \sum_{n=0}^{N_h} \| \sqrt{c}\, e_h' \|_{L^2(I_n)}^2 \Big)^{1/2}}_{\leq \|e_h\|_{\epsilon}} \\
			& \leq \frac{c_{\max}}{C_{\text{coer}}} \sum_{n=0}^{N_h} | u- \mathcal{I}_h u |^2_{H^1(I_n)} + \frac{C_{\text{coer}}}{4} \|e_h \|_{h}^2,
		\end{align*}
		having used $\varepsilon = \frac{C_{\text{coer}}}{2}$. Finally applying lemma \ref{lemma:interp_estimate} again yields 
		\begin{equation}
			\label{eq:proof_elliptic_energy_error_T1}
			|T_1| \leq \frac{c_{\max}}{C_{\text{coer}}} h^{2r} \,|u|_{H^{r+1}(\Omega)}^2 + \frac{C_{\text{coer}}}{4} \|e_h\|_{h}^2.
		\end{equation}
		To estimate $T_2$ we make again use of Young's inequality with $\displaystyle \varepsilon = \frac{\texttt{a}_n}{2}C_{\text{coer}}$ and find
		\begin{align*}
			|T_2| &= \Big|\sum_{n=0}^{N_h+1} \{c(x_n)(u-\mathcal{I}_n u)'(x_n)\}[e_h(x_n)] \Big| 
			\leq \Big|\sum_{n=0}^{N_h+1} \frac{\{c(x_n)(u-\mathcal{I}_n u)'(x_n)\}^2}{\texttt{a}_n \, C_{\text{coer}} } \Big|
			+ \frac{C_{\text{coer}}}{4} \sum_{n=0}^{N_h+1} \texttt{a}_n [e_h(x_n)]^2 \\
			& \leq \Big|\sum_{n=0}^{N_h+1} \frac{\{c(x_n)(u-\mathcal{I}_n u)'(x_n)\}^2}{\texttt{a}_n \, C_{\text{coer}} } \Big|
			+ \frac{C_{\text{coer}}}{4} \|e_h\|_{\epsilon}^2.
		\end{align*}
		Fix $n \in \{1,\ldots,N_h\} $, then $x_n$ is an interior face node and shared boundary of the elements $I_{n-1}, I_n$. Using the continuous trace inequality 
		(lemma \ref{lemma:cont_trace_ineq}) and consequently the interpolant estimate (lemma \ref{lemma:interp_estimate}) we estimate
		\begin{align*}
			|(u - \mathcal{I}_h u)'(x_n^+)|^2 
			&\leq 2 h_n^{-1} |u - \mathcal{I}_h u|_{H^1(I_n)}^2 + 2 h_n |u - \mathcal{I}_h u|_{H^2(I_n)}^2 \\
			&\leq 2 h_n^{-1} \, h_n^{2r} |u|_{H^{r+1}(I_n)}^2 + 2 h_n\, h_n^{2(r-1)} |u|_{H^{r+1}(I_n)}^2 
			= 4 h_n^{2r-1} \, |u|_{H^{r+1}(I_n)}^2,
		\end{align*}
		and analogously we find 
		\begin{equation*}
			|(u - \mathcal{I}_h u)'(x_n^-)|^2 \leq 4 h_{n-1}^{2r-1} \, |u|_{H^{r+1}(I_{n-1})}^2
		\end{equation*}
		for the lower element. Recall that $\displaystyle \texttt{a}_n = \frac{\sigma \, \max(c(x_n^+), c(x_n^-))}{\min(h_{n-1}, h_{n})}$ (see \ref{def:penalization_function}), using this 
		and the estimates above we find 
		\begin{align*}
			\frac{\{c(x_n)(u - \mathcal{I}_h u)'(x_n)\}^2}{\texttt{a}_n C_{\text{coer}}}
			&= \frac{c(x_n)^2 \min(h_{n-1}, h_n)}{\sigma C_{\text{coer}}\, \max(c(x_n^+), c(x_n^-))} \frac{| (u-\mathcal{I}_h u)'(x_n^-) + (u-\mathcal{I}_h u)'(x_n^+) |^2}{4}  \\
			&\leq \frac{c(x_n)}{\sigma C_{\text{coer}}} \frac{\min(h_{n-1}, h_{n})}{2}\Big( |(u-\mathcal{I}_h u)'(x_n^-)|^2 + |(u-\mathcal{I}_h u)'(x_n^+)|^2 \Big) \\
			& \leq \frac{c(x_n)}{\sigma C_{\text{coer}}} \frac{\min(h_{n-1}, h_{n})}{2}\Big( 4 h_{n-1}^{2r-1} \, |u|_{H^{r+1}(I_{n-1})}^2 + 4 h_{n}^{2r-1} \, |u|_{H^{r+1}(I_{n})}^2\Big) \\
			& \leq \frac{2 c_{\max}}{\sigma C_{\text{coer}}} h^{2r} \Big(|u|_{H^{r+1}(I_{n-1})}^2 + |u|_{H^{r+1}(I_{n})}^2 \Big).
		\end{align*}
		Similarly for the boundary nodes, i.e.\@ $n \in \{0, N_h+1\}$ we find 
		\begin{equation*}
			\frac{\{c(x_{n})(u - \mathcal{I}_h u)'(x_{n})\}^2}{\texttt{a}_{n} C_{\text{coer}}} 
			\leq \frac{4 c_{\max}}{\sigma C_{\text{coer}}} h^{2r} |u|^2_{H^{r+1}(I_{n})}.
		\end{equation*}
		This gives us now the tools to complete the estimate of $|T_2|$, we find
		\begin{equation}
			\label{eq:proof_elliptic_energy_error_T2}
			|T_2| \leq \frac{6 c_{\max}}{\sigma C_{\text{coer}}} h^{2r} |u|^2_{H^{r+1}(\Omega)} + \frac{C_{\text{coer}}}{4} \|e_h\|_{\epsilon}^2.
		\end{equation}
		Combining the estimates (\ref{eq:proof_elliptic_energy_error_T1}), (\ref{eq:proof_elliptic_energy_error_T2}) yields
		\begin{equation}
			\label{eq:proof_elliptic_energy_comb_T1_T2_estimate_of_eh_with_coerc}
			C_{\text{coer}} \|e_h\|_{\epsilon}^2 \leq \frac{C_{\text{coer}}}{2} \|e_h\|_{\epsilon}^2 + \frac{c_{\max}}{C_{\text{coer}}}(1 + \frac{6}{\sigma}) h^{2r} |u|^2_{H^{r+1}(\Omega)}. \nonumber
		\end{equation}
		By subtracting $\frac{C_{\text{coer}}}{2} \| e_h\|_{\epsilon}^2$ from both sides
		and then multiplying by $\frac{2}{C_{\text{coer}}} $ we find 
		\begin{equation}
			\| e_h\|_{\epsilon}^2 \leq \frac{2c_{\max}}{(C_{\text{coer}})^2} \frac{6 + \sigma}{\sigma} h^{2r} |u|^2_{H^{r+1}(\Omega)}. \nonumber
		\end{equation}
		This, together with the estimate (\ref{eq:proof_elliptic_energy_conv_first_term}), we can now finally plug back into (\ref{eq:proof_triangle_ineq_energy_conv_elliptic}) and get
		\begin{equation*}
			\|u - u_h \|_{\epsilon} \leq \sqrt{c_{\max}}\Big(1 + \frac{\sqrt{2(\sigma + 6)}}{C_{\text{coer}}\sqrt{\sigma}}\Big) \, h^r |u|_{H^{r+1}(\Omega)}
			= C_{\epsilon} h^r |u|_{H^{r+1}(\Omega)},
		\end{equation*}
		for $\displaystyle C_{\epsilon} :=  \sqrt{c_{\max}}\Big(1 + \frac{\sqrt{2(\sigma + 6)}}{C_{\text{coer}}\sqrt{\sigma}}\Big)$, which proofs (\ref{eq:elliptic_energy_convergence_rate}).
	\end{proofstep}
	\\
\end{proof}

Next we show that measuring the error in the $L^2$-norm gives us a power of $h$ more than in the energy norm. This coincides with the convergence rates known from
continuous FEM. 

\begin{theorem}[$L^2$-convergence]
	\label{thr:elliptic_l2_convergence}
	Under the same assumptions as in theorem \ref{thr:elliptic_energy_convergence}, there exists a constant $C_{L}(C_{\epsilon}, \Omega, c, \sigma) > 0$ 
	independent of the meshsize $h$ and the solution $u$, such that
	\begin{equation}
		\label{eq:elliptic_l2_convergence_rate}
		\|u - u_h \|_{L^2(\Omega)} \leq C_{L} h^{r+1} |u|_{H^{r+1}(\Omega)}.
	\end{equation}
\end{theorem}
\begin{proof}
	We will prove the theorem using a duality argument often referred to as \textit{Aubin-Nitsche trick}.
	\begin{proofstep}
		Define the error $e := u - u_h \in V$ and consider the dual problem 
		\begin{align}
			&-(c \, \varphi ')' = e \qquad \text{ in }\Omega \label{eq:proof_elliptic_l2_conv_dual_problem}, \\
			&\varphi(0) = \varphi(1) = 0 \label{eq:proof_elliptic_l2_conv_dual_problem_bc}.
		\end{align}
		By Lax-Milgram there exists a unique weak solution $\varphi \in H^1_0(\Omega)$ of (\ref{eq:proof_elliptic_l2_conv_dual_problem})-(\ref{eq:proof_elliptic_l2_conv_dual_problem_bc}).
		Furthermore by elliptic regularity it holds that $\varphi \in H^2(\Omega)$ with
		\begin{equation}
			\label{eq:proof_elliptic_l2_conv_elliptic_regularity}
			\| \varphi \|_{H^2(\Omega)} \leq \tilde{C} \|e \|_{L^2(\Omega)},
		\end{equation}
		where $\tilde{C} > 0$ is a constant only dependent on $\Omega$ and the coefficient $c \in C^1(\Omega)$(see for example Evans chapter 6.3 \cite{EvansPDE}).
		By the consistency of the SIPG variational formulation (see theorem \ref{thr:elliptic_consistency_sipg_variational_formulation}) $\varphi$ satisfies
		\begin{equation*}
			b(\varphi, v) = (e, v)_{L^2(\Omega)} \qquad \forall v \in V.
		\end{equation*}
		Note that the right-hand side contains only the $L^2$-term since the dual problem is posed with homogeneous Dirichlet boundary conditions (\ref{eq:proof_elliptic_l2_conv_dual_problem_bc}).
		In particular since $e \in V$ we have $b(\varphi, e) = \| e \|_{L^2(\Omega)}^2$. \\
		Next we interpolate $\varphi$ using the $\mathcal{P}^1$-interpolant $\mathcal{I}_h^1$ (not $\mathcal{P}^r$), this means $\mathcal{I}_h^1 \varphi \in V_h^r(\mathcal{T}_h)$
		since $r \geq 1$. 
		Now using Galerkin orthogonality (\ref{eq:galerkin_orthogonality}) and the symmetry of the bilinear form $b$ we find
		\begin{equation}
			\| e \|_{L^2(\Omega)}^2 = b(\varphi, e) = b(e, \varphi - \mathcal{I}_h^1 \varphi) \nonumber,
		\end{equation}
		which in turn we can estimate using Cauchy-Schwarz as follows:
		\begin{align*}
			b(e, \varphi - \mathcal{I}_h^1 \varphi) 
			& = \sum_{n=0}^{N_h} \int_{I_n} c \, e' (\varphi - \mathcal{I}_h^1 \varphi)' \text{ d}x 
			- \sum_{n=0}^{N_h + 1} \{ c(x_n) (\varphi - \mathcal{I}_h^1 \varphi)'(x_n) \}[e(x_n)] \\
			&- \sum_{n=0}^{N_h + 1} \{ c(x_n) e'(x_n)\}\underbrace{[(\varphi - \mathcal{I}_h^1 \varphi)(x_n)]}_{=0} 
			+ \sum_{n=0}^{N_h + 1} \texttt{a}_n [e(x_n)]\underbrace{[(\varphi - \mathcal{I}_h^1 \varphi)(x_n)]}_{=0} \\
			& \leq \sqrt{c_{\max}} \Big(\sum_{n=0}^{N_h} \int_{I_n}  \abs{(\varphi - \mathcal{I}_h^1 \varphi)'}^2 \text{d}x \Big)^{1/2}
			\underbrace{\Big(\sum_{n=0}^{N_h} \int_{I_n} c \abs{e'}^2 \text{d}x \Big)^{1/2}}_{\leq \norm{e}_{\epsilon}} \\
			&+ \Big(\sum_{n=0}^{N_h + 1} \frac{{\{ c(x_n) (\varphi - \mathcal{I}_h^1 \varphi)'(x_n) \}}^2}{\texttt{a}_n} \Big)^{1/2} 
			\underbrace{\Big(\sum_{n=0}^{N_h + 1} \texttt{a}_n [e(x_n)]^2 \Big)^{1/2}}_{\leq \norm{e}_{\epsilon}}.
		\end{align*}
		We know from theorem \ref{thr:elliptic_energy_convergence} that $\norm{e}_{\epsilon} \leq C_{\epsilon} h^r |u|_{H^{r+1}(\Omega)}$,
		and from the proof that 
		\begin{enumerate}
			\item $ \displaystyle \abs{\varphi - \mathcal{I}_h^1 \varphi}_{H^1(\Omega)}^2 \leq h^2 \abs{\varphi}_{H^2(\Omega)}^2 \qquad \forall n \in \countset{0}{N_h} $,
			\item $\displaystyle \frac{{\{ c(x_n) (\varphi - \mathcal{I}_h^1 \varphi)'(x_n) \}}^2}{\texttt{a}_n} 
				\leq \gamma_n \frac{c_{\max}}{\sigma} h^2 \, \Big( \abs{\varphi}_{H^2(I_{n-1})}^2 + \abs{\varphi}_{H^2(I_{n})}^2 \Big) \qquad \forall n \in \countset{0}{N_h+1}$,
		\end{enumerate}
		where $\gamma_n = 2$ for $n \in \countset{1}{N_h}$ and $\gamma_n = 4$ for $n \in \{0, N_h+ 1\}$. Putting all of the above together we find
		\begin{equation*}
			\norm{e}_{L^2(\Omega)}^2 \leq \Big( \sqrt{c_{\max}} + \sqrt{\frac{6 c_{\max}}{\sigma}} \Big) C_{\epsilon} h^{r+1} \abs{\varphi}_{H^2(\Omega)} \abs{u}_{H^{r+1}(\Omega)}
			\leq \Big(1 + \sqrt{\frac{6}{\sigma}}\Big)\sqrt{c_{\max}} C_{\epsilon} \tilde{C} \norm{e}_{L^2(\Omega)} \abs{u}_{H^{r+1}(\Omega)},
		\end{equation*}
		where we have used the estimate (\ref{eq:proof_elliptic_l2_conv_elliptic_regularity}). Dividing by $\norm{e}_{L^2(\Omega)}$ on both sides finally yields 
		\begin{equation}
			\norm{e}_{L^2(\Omega)} \leq C_{L} h^{r+1} \abs{u}_{H^{r+1}(\Omega)} \nonumber,
		\end{equation}
		where $C_L = \Big(1 + \sqrt{\frac{6}{\sigma}}\Big)\sqrt{c_{\max}} C_{\epsilon} \tilde{C} $. \\
	\end{proofstep}
\end{proof}
