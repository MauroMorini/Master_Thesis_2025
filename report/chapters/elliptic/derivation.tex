\chapter{DG for Elliptic Problem}

First we consider a time-independent elliptic problem. Not only is it
useful for initiation to the subject to first consider a simpler elliptic problem, but it
is also an essential preparational step in deriving the SIPG bilinear form for the
elliptic part of the hyperbolic problem as well.
\\
The goal of this chapter is to build all the necessary theoretical and practical
tools to solve a given elliptic problem
numerically and then experimentally test the method for different parameters.
We will define the necessary notation and derive
the SIPG variational formulation as well as in detail describe further implementation steps as
for example what basis of the finite element space we chose and how to derive local matrices.
Finally this chapter will also include some well established theoretical results in
the context of discontinuous Galerkin methods.
The derivation
of the bilinear form is inspired by
Chapter 1 in \cite{riviere2008} as well as \cite{georgoulis2011Springer} and \cite{grote2006}
for cross reference.

%---Problem---------------------------------------------------------------
\section{Problem}
\label{sec:elliptic_problem}
We consider the following elliptic model problem:
\begin{equation}
	\label{eq:elliptic_pde}
	-(c(x)u'(x))' = f(x) \qquad \forall x\in \Omega
\end{equation}
\begin{equation}
	\label{eq:elliptic_pde_bc}
	u(0) = g_0, u(1) = g_1
\end{equation}
where $\Omega = (0,1)$ is the domain, $g_0, g_1 \in \mathbb{R}$ are
Dirichlet boundary conditions, $f \in L^2(\Omega)$ and $c:\Omega \to \mathbb{R}$
satisfies:
\[
	c_{\min} \leq c(x) \leq c_{\max} \qquad \forall x\in \Omega
\]
for $0 < c_{\min} \leq c_{\max}$.
Multiplying the solution by a test function and integrating by parts over $\Omega$ we get the
standard weak formulation: \\
Find $u \in \{v \in H^1(\Omega)\, | \,  v(0) = g_0, v(1) = g_1\} $ such that:
\begin{equation}
	\label{eq:elliptic_weak_form}
	a(u,v) = (f,v)_{L^2(\Omega)} \qquad \forall v \in C_c^{\infty}(\Omega)
\end{equation}
Where
\[
	a:H^1(\Omega) \times H^1(\Omega) \to \mathbb{R}, \qquad (u,v) \mapsto \int_{\Omega} c(x)u'(x)v'(x) \text{d}x
\]
defines the standard elliptic bilinear form on $H^1(\Omega)$ and
\[
	(u,v)_{L^2(\Omega)} = \int_{\Omega} uv \,\text{d}x
\]

denotes the $L^2$-inner product. \\
If we assume $f \in L^2(\Omega)$ and $c \in C^1(\Omega)$ we know by \textit{Lax-Milgram} 
that there exists a unique (weak) solution of (\ref{eq:elliptic_weak_form}) and from the \textit{elliptic regularity theory} we 
can conclude higher regularity of the weak solution, namely $u \in H^2(\Omega)$. For reference see chapter 6.2, 6.3 in \cite{EvansPDE}.

%---Discretization---------------------------------------------------------
\section{Discretization}
Let $0=x_0 < \cdots < x_{N+1} = 1$ be the mesh faces, $I_n = (x_n, x_{n+1})$ for $n = 0,\ldots,N$ be the elements and $\mathcal{T}_h = \{I_n\}_{n=0}^N$ a partition
of $\Omega$ for some fixed $N\in \mathbb{N}$.
We denote the element length by $h_n = x_{n+1} - x_{n}$ for $n=0,\ldots,N$ and the global meshsize by
$h = \max_{n} h_n$.
Next we define the discontinuous finite element space
\begin{tcolorbox}[mythmstyle, colback=green!10!white]
	\begin{equation}
		V_h^r(\mathcal{T}_h) = \{v \in L^2(\Omega) |\, v|_{I_n} \in \mathcal{P}^r(I_n) \}
	\end{equation}
\end{tcolorbox}
where $\mathcal{P}^r(I_n)$ denotes the space of polynomials $p:I_n \to \mathbb{R}$ of degree $r$
for $r \in \mathbb{N}$. When the context allows it, we will denote the
finite element space with just $V_h$ for simplicity.
$V_h$ is our final approximation space in which the numerical solution
lays.
We observe that in contrast to a continuous finite element approximation space
here the resulting solution is a priori discontinuous by construction.
Furthermore we have here $V_h \not\subset H^1(\Omega)$.
This is especially apparent in 1d due to the Sobolev embedding $H^1(\Omega) \subset C^0(\Omega)$.
Any discontinuous element of $V_h$ can therefore not be in $H^1(\Omega)$. \\
To proceed we will require the following trace operators:

\begin{definition}
	\label{def:jump_average}
	Let $v:\Omega \to \mathbb{R}$ be piecewise continuous and let $n \in
		\{1,\ldots,N\}$
	\begin{enumerate}[label=\textnormal{(\roman*)}]
		\item We denote $v(x_n^+) := \lim_{x \searrow x_n} v(x), v(x_n^-) := \lim_{x \nearrow x_n} v(x)$
		      the limit from above/below.
		\item We define the \textbf{jump} at $x_n$ as
		      \[
			      [v(x_n)]:= v(x_n^-) - v(x_n^+)
		      \]
		      and the \textbf{average} at $x_n$ as
		      \[
			      \{v(x_n)\}:= \frac{v(x_n^+) + v(x_n^-)}{2}
		      \]
		      furthermore by convention we set:
		      \[
			      [v(x_0)] := -v(x_0^+),\quad [v(x_{N+1})] := v(x_{N+1}^-),\quad
			      \{v(x_0)\}:=v(x_0^+),\quad \{v(x_{N+1})\}:= v(x_{N+1}^-)
		      \]
	\end{enumerate}
\end{definition}

%---Variational Formulation--------------------------------------------------------
\section{Variational Formulation}
\label{sec:elliptic_var_form}
To derive the SIPG variational formulation, let $v \in V_h$ be a test
function. As mentioned in section \ref{sec:elliptic_problem} we can assume that the coefficient $c \in C^1(\Omega)$ and
the exact solution $u \in H^2(\Omega) \subset C^1(\Omega)$.
Due to the discontinuity of the test function in contrast to
continuous FEM we multiply $u$ with $v$ on each element $I_n$
and integrate by parts locally
\begin{equation*}
	\int_{x_n}^{x_{n+1}} fv\, \text{d}x = -\int_{x_n}^{x_{n+1}} (cu')'v\, \text{d}x
	= \int_{x_n}^{x_{n+1}} cu'v'\, \text{d}x
	-  cu'v\Big|_{x_n}^{x_{n+1}} \qquad \forall n=0,\ldots,N
\end{equation*}
then sum over all elements
\begin{equation}
	\label{eq:elliptic_sipg_var_form_incomplete}
	(f,v)_{L^2(\Omega)} = \sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
	-\sum_{n=0}^{N+1} [c(x_n)u'(x_n)v(x_n)]
\end{equation}
where we have used that $\sum_{n=0}^N  w \Big|_{x_n}^{x_{n+1}} = w(x_{N+1}^-) -
	w(x_{N}^+) + w(x_{N}^-) - \cdots - w(x_1^+) + w(x_1^-) - w(x_0^+) = \sum_{n=0}^{N+1} [w(x_n)]$ for any piece-wise continuous function $w$.
\\
By our construction are $c, u'$ continuous on $\Omega$, this means
\begin{equation}
	\label{eq:id_1_cu_jump_zero}
	[c(x_n)u'(x_n)v(x_n)] = c(x_n)u'(x_n)[v(x_n)] = \{c(x_n)u'(x_n)\}[v(x_n)] \qquad \forall n=0,\ldots,N+1
\end{equation}
and
\begin{equation}
	\label{eq:id_2_u_jump_zero}
	[u(x_n)] = 0 \qquad \forall n=1,\ldots,N
\end{equation}
To derive the final variational form we will now have to add two additional terms
to (\ref{eq:elliptic_sipg_var_form_incomplete}): \\
\textbf{Step 1.} Firstly we need to symmetrize our currently non-symmetrical right hand side
which will correspond to the SIPG bilinear form. To do so
we add the symmetry term $-\sum_{n=0}^{N+1} \{c(x_n)v'(x_n)\}[u(x_n)]$ on both sides of
(\ref{eq:elliptic_sipg_var_form_incomplete}) so we get
\begin{align*}
	  & (f,v)_{L^2(\Omega)}-g_1c(x_{N+1}^-)v'(x_{N+1}^-) + g_0c(x_0^+)v'(x_0^+) \\
	= & \sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
	-\sum_{n=0}^{N+1} \{c(x_n)u'(x_n)\}[v(x_n)] + \{c(x_n)v'(x_n)\}[u(x_n)]
\end{align*}
where on the left hand side of the equation we have applied (\ref{eq:id_2_u_jump_zero})
for the interior node contributions of the sum (which therefore vanish), and the boundary condition (\ref{eq:elliptic_pde_bc})
ensuring the left hand side to be soley dependent on $v$.\\
\textbf{Step 2.} The bilinear form we seek to create will (for now) be defined on $V_h\times V_h$
meaning it will intake discontinuous functions. In particular the numerical
solution will be a discontinuous function wheras the exact solution is continuous.
To counterweigh this discrepancy we need to integrate a penalization mechanism, seeking to
minimize discontinuous behaviors. Technically speaking this penalization term
will guarantee coercivity of the bilinear form (see section \ref{sec:existence_uniqueness_elliptic_discrete_problem}). \\
Let $\sigma > 0$ constant, we define:
\begin{equation*}
	\texttt{c}_n :=
	\begin{cases}
		\max(c(x_n^+), c(x_n^-)), & n=1,\ldots,N \\
		c(x_n^+),                 & n=0          \\
		c(x_n^-),                 & n=N+1
	\end{cases},
	\qquad \texttt{h}_n :=
	\begin{cases}
		\min(h_n, h_{n-1}), & n=1,\ldots,N    \\
		h_n,                & n\in \{0, N+1\}
	\end{cases}
\end{equation*}
with this we define our penalization parameter
\begin{tcolorbox}[mythmstyle, colback=green!10!white]
	\begin{equation}
		\label{def:penalization_function}
		\texttt{a}_n := \frac{\sigma \texttt{c}_n}{\texttt{h}_n} > 0 \qquad \forall n=0\ldots,N+1
	\end{equation}
\end{tcolorbox}
Similarly to Step 1 we can now add the penalty term $\sum_{n=0}^{N+1} \texttt{a}_n[u(x_n)][v(x_n)]$
on both sides of (\ref{eq:elliptic_sipg_var_form_incomplete}) and get the final
\textit{discrete} SIPG variational formulation.\\
\begin{tcolorbox}[mythmstyle, colback=green!10!white]
	Find $u_h \in V_h$ such that:
	\begin{equation}
		\label{eq:discrete_var_form_elliptic}
		b_h(u_h, v) = \ell_h(v), \qquad \forall v\in V_h
	\end{equation}
	where
	\begin{align*}
		b_h(u,v) & = \sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
		-\sum_{n=0}^{N+1} \{c(x_n)u'(x_n)\}[v(x_n)] + \{c(x_n)v'(x_n)\}[u(x_n)]
		+\sum_{n=0}^{N+1} \texttt{a}_n[u(x_n)][v(x_n)]                                     \\
		\ell_h(v)  & = (f,v)_{L^2(\Omega)}-g_1c(x_{N+1}^-)v'(x_{N+1}^-) + g_0c(x_0^+)v'(x_0^+)
		+ \texttt{a}_{N+1}g_1v(x_{N+1}^-) + \texttt{a}_0 g_0v(x_{0}^+)
	\end{align*}
	for $u,v\in V_h$.
\end{tcolorbox}

%---Boundary Conditions----------------------------------------------------------
\section{Boundary Conditions}
By adding the terms $-\sum_{n=0}^{N+1} \{c(x_n)v'(x_n)\}[u(x_n)], \sum_{n=0}^{N+1} \texttt{a}_n[u(x_n)][v(x_n)]$ on both sides
of (\ref{eq:elliptic_sipg_var_form_incomplete}) we \textit{weakly} imposed the Dirichlet
boundary conditions into the variational form. This stands in contrast to how boundary
conditions are usually imposed in continuous FEM. Indeed one could also impose them strongly,
meaning we could define
\begin{equation*}
	V_h^r(\mathcal{T}_h) = \{v \in L^2(\Omega) |\, v|_{I_n} \in \mathcal{P}^r(I_n), v(x_0)=g_0, v(x_{N+1})=g_1 \}
\end{equation*}
but this soley as a side note, we will continue to work with purely weakly imposed
boundary conditions.  \\ \\

One could alternatively desire to implement \textit{Neumann} boundary conditions, this slightly changes the variational formulation.
We illustrate the idea on the following example boundary condition. A solution
$u$ should satisfy:
\[
	u(0) = g_{0}, u'(1)\cdot n_1 = g_{1}
\]
where again $g_0, g_1 \in \mathbb{R}$ are the boundary values and $n_1$ denotes the outward normal
of the domain at the upper boundary. In 1d we trivially have $n_1 = 1, n_0 = -1$, where $n_0$ denotes the outward
normal at the lower boundary.

Now recall the initial incomplete formulation (\ref{eq:elliptic_sipg_var_form_incomplete}). First we take the
Neumann boundary contribution $\{c(x_{N+1})u'(x_{N+1})\}[v(x_{N+1})]$ to the other side of the equation. We get
\[
	\sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
	-\sum_{n=0}^{N} \{c(x_n)u'(x_n)\}[v(x_n)] = (f,v)_{L^2(\Omega)}
	+ g_1c(x_{N+1}^-)v'(x_{N+1}^-)
\]
We have used $\{c(x_{N+1})u'(x_{N+1})\}[v(x_{N+1})] = c(x_{N+1}^-)u'(x_{N+1}^-)v(x_{N+1}^-)\cdot n_1 = g_1 c(x_{N+1}^-)v(x_{N+1}^-)$

From here on
we proceed similarly as in the Dirichlet case. The main difference is that we always ommit the boundary face with the Neumann
boundary condition. \\
We add the symmetry and penalty terms
\[
	-\sum_{n=0}^{N} \{c(x_n)v'(x_n)\}[u(x_n)]
	+\sum_{n=0}^{N} \texttt{a}_n[u(x_n)][v(x_n)]
\]
to both sides, using again that the real solution has zero jump on the interior faces and
applying the boundary conditions we finally derive the variational form

\begin{align*}
	 & \sum_{n=0}^N \int_{I_n} cu'v'\, \text{d}x
	-\sum_{n=0}^{N} \{c(x_n)u'(x_n)\}[v(x_n)] + \{c(x_n)v'(x_n)\}[u(x_n)]
	+\sum_{n=0}^{N} \texttt{a}_n[u(x_n)][v(x_n)]                                \\
	 & = (f,v)_{L^2(\Omega)} + g_0c(x_0^+)v'(x_0^+) + \texttt{a}_0 g_0v(x_{0}^+)
	+ g_1c(x_{N+1}^-)v(x_{N+1}^-)
\end{align*}
